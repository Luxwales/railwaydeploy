import{j as E,p as N,f as S,l as _,d as j,A as i,V as O,h as M,L as q,y as L,r as h,w,a8 as U,a0 as p,a1 as V,a2 as G,M as J,a3 as K}from"./index.3fff4c75.js";function P(e){const r=E("useRender");r.render=e}const ie=(e,r)=>{const a=e.__vccOpts||e;for(const[t,c]of r)a[t]=c;return a};const Q=N({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function X(e){return{dimensionStyles:S(()=>({height:_(e.height),maxHeight:_(e.maxHeight),maxWidth:_(e.maxWidth),minHeight:_(e.minHeight),minWidth:_(e.minWidth),width:_(e.width)}))}}function Y(e){return{aspectStyles:S(()=>{const r=Number(e.aspectRatio);return r?{paddingBottom:String(1/r*100)+"%"}:void 0})}}const Z=j({name:"VResponsive",props:{aspectRatio:[String,Number],contentClass:String,...Q()},setup(e,r){let{slots:a}=r;const{aspectStyles:t}=Y(e),{dimensionStyles:c}=X(e);return P(()=>{var s;return i("div",{class:"v-responsive",style:c.value},[i("div",{class:"v-responsive__sizer",style:t.value},null),(s=a.additional)==null?void 0:s.call(a),a.default&&i("div",{class:["v-responsive__content",e.contentClass]},[a.default()])])}),{}}});function ee(e,r){if(!O)return;const a=r.modifiers||{},t=r.value,{handler:c,options:s}=typeof t=="object"?t:{handler:t,options:{}},l=new IntersectionObserver(function(){var d;let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],u=arguments.length>1?arguments[1]:void 0;const v=(d=e._observe)==null?void 0:d[r.instance.$.uid];if(!v)return;const f=g.some(b=>b.isIntersecting);c&&(!a.quiet||v.init)&&(!a.once||f||v.init)&&c(f,g,u),f&&a.once?k(e,r):v.init=!0},s);e._observe=Object(e._observe),e._observe[r.instance.$.uid]={init:!1,observer:l},l.observe(e)}function k(e,r){var a;const t=(a=e._observe)==null?void 0:a[r.instance.$.uid];!t||(t.observer.unobserve(e),delete e._observe[r.instance.$.uid])}const te={mounted:ee,unmounted:k},ne=te,re=N({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),z=(e,r)=>{let{slots:a}=r;const{transition:t,...c}=e,{component:s=L,...l}=typeof t=="object"?t:{};return M(s,q(typeof t=="string"?{name:t}:l,c),a)},se=j({name:"VImg",directives:{intersect:ne},props:{aspectRatio:[String,Number],alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,width:[String,Number],...re()},emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,r){let{emit:a,slots:t}=r;const c=h(""),s=h(),l=h(e.eager?"loading":"idle"),d=h(),g=h(),u=S(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),v=S(()=>u.value.aspect||d.value/g.value||0);w(()=>e.src,()=>{f(l.value!=="idle")}),w(v,(n,o)=>{!n&&o&&s.value&&y(s.value)}),U(()=>f());function f(n){if(!(e.eager&&n)&&!(O&&!n&&!e.eager)){if(l.value="loading",u.value.lazySrc){const o=new Image;o.src=u.value.lazySrc,y(o,null)}!u.value.src||p(()=>{var o,m;if(a("loadstart",((o=s.value)==null?void 0:o.currentSrc)||u.value.src),(m=s.value)!=null&&m.complete){if(s.value.naturalWidth||$(),l.value==="error")return;v.value||y(s.value,null),b()}else v.value||y(s.value),R()})}}function b(){var n;R(),l.value="loaded",a("load",((n=s.value)==null?void 0:n.currentSrc)||u.value.src)}function $(){var n;l.value="error",a("error",((n=s.value)==null?void 0:n.currentSrc)||u.value.src)}function R(){const n=s.value;n&&(c.value=n.currentSrc||n.src)}let I=-1;function y(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const m=()=>{clearTimeout(I);const{naturalHeight:x,naturalWidth:H}=n;x||H?(d.value=H,g.value=x):!n.complete&&l.value==="loading"&&o!=null?I=window.setTimeout(m,o):(n.currentSrc.endsWith(".svg")||n.currentSrc.startsWith("data:image/svg+xml"))&&(d.value=1,g.value=1)};m()}const W=S(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),B=()=>{var n;if(!u.value.src||l.value==="idle")return null;const o=i("img",{class:["v-img__img",W.value],src:u.value.src,srcset:u.value.srcset,alt:"",sizes:e.sizes,ref:s,onLoad:b,onError:$},null),m=(n=t.sources)==null?void 0:n.call(t);return i(z,{transition:e.transition,appear:!0},{default:()=>[V(m?i("picture",{class:"v-img__picture"},[m,o]):o,[[K,l.value==="loaded"]])]})},C=()=>i(z,{transition:e.transition},{default:()=>[u.value.lazySrc&&l.value!=="loaded"&&i("img",{class:["v-img__img","v-img__img--preload",W.value],src:u.value.lazySrc,alt:""},null)]}),F=()=>t.placeholder?i(z,{transition:e.transition,appear:!0},{default:()=>[(l.value==="loading"||l.value==="error"&&!t.error)&&i("div",{class:"v-img__placeholder"},[t.placeholder()])]}):null,A=()=>t.error?i(z,{transition:e.transition,appear:!0},{default:()=>[l.value==="error"&&i("div",{class:"v-img__error"},[t.error()])]}):null,D=()=>e.gradient?i("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,T=h(!1);{const n=w(v,o=>{o&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{T.value=!0})}),n())})}return P(()=>V(i(Z,{class:["v-img",{"v-img--booting":!T.value}],style:{width:_(e.width==="auto"?d.value:e.width)},aspectRatio:v.value,"aria-label":e.alt,role:e.alt?"img":void 0},{additional:()=>i(J,null,[i(B,null,null),i(C,null,null),i(D,null,null),i(F,null,null),i(A,null,null)]),default:t.default}),[[G("intersect"),{handler:f,options:e.options},null,{once:!0}]])),{currentSrc:c,image:s,state:l,naturalWidth:d,naturalHeight:g}}}),le=N({tag:{type:String,default:"div"}},"tag");export{se as V,ie as _,Q as a,X as b,le as m,P as u};
